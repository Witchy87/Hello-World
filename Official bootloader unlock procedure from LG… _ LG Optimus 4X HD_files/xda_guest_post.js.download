function b64EncodeUnicode(str){return btoa(encodeURIComponent(str).replace(/%([0-9A-F]{2})/g,function(match,p1){return String.fromCharCode('0x'+p1);}));}
function b64DecodeUnicode(str){return decodeURIComponent(escape(atob(str)));}
jQuery(document).ready(function($){var qrthread=$('#qr_threadid').val();var qrpost=$('#qr_postid').val();if($("input[name='loggedinuser']").val()==0)
var isloggedin=false;else
var isloggedin=true;if($.cookie('qrcontent')){var existingqr=JSON.parse($.cookie('qrcontent'));if(existingqr.qrthread==qrthread){console.log("Matched QR thread cookie");$('#vB_Editor_QR_textarea').val(b64DecodeUnicode(existingqr.qrtext));$('html, body').animate({scrollTop:$('#vB_Editor_QR_textarea').offset().top-200},1000);$('#vB_Editor_QR_textarea').effect("highlight",{},3000).focus();}else{$.cookie('qrcontent',false,{expires:-1,path:'/'});}}
$('#qr_submit').click(function(e){var qrtext=$('#vB_Editor_QR_textarea').val();var regex=new RegExp(/(http[s]?|www|(\[\/?(?:b|i|u|url|quote|code|img|color|size)*?.*?\]))/);if(qrtext==''){$.cookie('qrcontent','',{expires:-1,path:'/'});event.preventDefault();}else if(!isloggedin&&regex.test(qrtext)){event.preventDefault();$("#ajax_post_errors_message").html("Post contains a url or bbcode. Please remove and try submitting again.");$("#ajax_post_errors").show();$("#qr_posting_msg").hide();}else if(!isloggedin){var qrcontent={'qrtext':b64EncodeUnicode(qrtext),'qrpost':qrpost,'qrthread':qrthread};$.cookie('qrcontent',JSON.stringify(qrcontent),{expires:7,path:'/'});$.cookie('returnurl','https://forum.xda-developers.com/newreply.php?t='+qrthread,{expires:1,path:'/'});}});});